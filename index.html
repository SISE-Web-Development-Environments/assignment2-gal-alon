<!DOCTYPE html>
<html>

<head>
	<link rel="stylesheet" type="text/css" href="./resources/css/style.css" />
	<script src="./jquery-3.4.1.slim.min.js"></script>
	<script type="text/javascript" src="./app.js"></script>
	<script type="text/javascript" src="./validation.js"></script>
</head>

<body>
	<div style="text-align:center;" id="header">
		<!--Put our Names-->
		<div style="text-align:center;" id="menu">
			<div class="header-button" style="cursor: pointer;" id="loginb"></div>
			<div class="header-button" style="cursor: pointer;" id="registerb"></div>
			<div class="header-button" style="cursor: pointer;" id="settingsb"></div>
			<div class="header-button" style="cursor: pointer;" id="aboutb"></div>
			<div class="header-button" style="cursor: pointer;" id="playb"></div>
		</div>
		<img id="logo" style="float: right; width:auto; cursor: pointer;" src=./resources/images/pacman-3d-png-2.png
			height=100% />

	</div><br><br>
	<div id="content">
		<div class="contnt" id="welcome">
			<br>
			<img id="big_logo" src=./resources/images/logo2.png height="22%" style="width:auto;" /><br>
			<div style="cursor: pointer;" id="registerbig"></div>
			<div style="cursor: pointer;" id="loginbig"></div>
		</div>

		<div class="contnt" id="login" style="display: none; ">
			<h1> Please login before you play the game: </h1><br>


			<h3>User Name:</h3>
			<input id="userL" type="text" /><br>
			<h3>Password:</h3>
			<input id="passL" type="password" /><br><br>
			<input id="loginsubmit" type="submit" value="Login">
		</div>

		<div class="contnt" id="register" style="display: none; ">
			<h1> Please fill the registration form: </h1><br>


			<h3>User Name:</h3>
			<input id="userR" type="text" /><br>
			<h3>Password:</h3>
			<input id="passR" type="password" /><br>
			<h3>Mail address:</h3>
			<input id="mailR" type="text" /><br>
			<h3>Full Name:</h3>
			<input id="nameR" type="text" /><br>
			<h3>Birthday:</h3>
			<select name="dob-day" id="dob-day">
				<option value="">Day</option>
				<option value="">---</option>
				<option value="01">01</option>
				<option value="02">02</option>
				<option value="03">03</option>
				<option value="04">04</option>
				<option value="05">05</option>
				<option value="06">06</option>
				<option value="07">07</option>
				<option value="08">08</option>
				<option value="09">09</option>
				<option value="10">10</option>
				<option value="11">11</option>
				<option value="12">12</option>
				<option value="13">13</option>
				<option value="14">14</option>
				<option value="15">15</option>
				<option value="16">16</option>
				<option value="17">17</option>
				<option value="18">18</option>
				<option value="19">19</option>
				<option value="20">20</option>
				<option value="21">21</option>
				<option value="22">22</option>
				<option value="23">23</option>
				<option value="24">24</option>
				<option value="25">25</option>
				<option value="26">26</option>
				<option value="27">27</option>
				<option value="28">28</option>
				<option value="29">29</option>
				<option value="30">30</option>
				<option value="31">31</option>
			</select>
			<select name="dob-month" id="dob-month">
				<option value="">Month</option>
				<option value="">-----</option>
				<option value="01">01</option>
				<option value="02">02</option>
				<option value="03">03</option>
				<option value="04">04</option>
				<option value="05">05</option>
				<option value="06">06</option>
				<option value="07">07</option>
				<option value="08">08</option>
				<option value="09">09</option>
				<option value="10">10</option>
				<option value="11">11</option>
				<option value="12">12</option>
			</select>
			<select name="dob-year" id="dob-year">
				<option value="">Year</option>
				<option value="">----</option>
				<option value="2012">2020</option>
				<option value="2012">2019</option>
				<option value="2012">2018</option>
				<option value="2012">2017</option>
				<option value="2012">2016</option>
				<option value="2012">2015</option>
				<option value="2012">2014</option>
				<option value="2012">2013</option>
				<option value="2012">2012</option>
				<option value="2011">2011</option>
				<option value="2010">2010</option>
				<option value="2009">2009</option>
				<option value="2008">2008</option>
				<option value="2007">2007</option>
				<option value="2006">2006</option>
				<option value="2005">2005</option>
				<option value="2004">2004</option>
				<option value="2003">2003</option>
				<option value="2002">2002</option>
				<option value="2001">2001</option>
				<option value="2000">2000</option>
				<option value="1999">1999</option>
				<option value="1998">1998</option>
				<option value="1997">1997</option>
				<option value="1996">1996</option>
				<option value="1995">1995</option>
				<option value="1994">1994</option>
				<option value="1993">1993</option>
				<option value="1992">1992</option>
				<option value="1991">1991</option>
				<option value="1990">1990</option>
				<option value="1989">1989</option>
				<option value="1988">1988</option>
				<option value="1987">1987</option>
				<option value="1986">1986</option>
				<option value="1985">1985</option>
				<option value="1984">1984</option>
				<option value="1983">1983</option>
				<option value="1982">1982</option>
				<option value="1981">1981</option>
				<option value="1980">1980</option>
				<option value="1979">1979</option>
				<option value="1978">1978</option>
				<option value="1977">1977</option>
				<option value="1976">1976</option>
				<option value="1975">1975</option>
				<option value="1974">1974</option>
				<option value="1973">1973</option>
				<option value="1972">1972</option>
				<option value="1971">1971</option>
				<option value="1970">1970</option>
				<option value="1969">1969</option>
				<option value="1968">1968</option>
				<option value="1967">1967</option>
				<option value="1966">1966</option>
				<option value="1965">1965</option>
				<option value="1964">1964</option>
				<option value="1963">1963</option>
				<option value="1962">1962</option>
				<option value="1961">1961</option>
				<option value="1960">1960</option>
				<option value="1959">1959</option>
				<option value="1958">1958</option>
				<option value="1957">1957</option>
				<option value="1956">1956</option>
				<option value="1955">1955</option>
				<option value="1954">1954</option>
				<option value="1953">1953</option>
				<option value="1952">1952</option>
				<option value="1951">1951</option>
				<option value="1950">1950</option>
				<option value="1949">1949</option>
				<option value="1948">1948</option>
				<option value="1947">1947</option>
				<option value="1946">1946</option>
				<option value="1945">1945</option>
				<option value="1944">1944</option>
				<option value="1943">1943</option>
				<option value="1942">1942</option>
				<option value="1941">1941</option>
				<option value="1940">1940</option>
				<option value="1939">1939</option>
				<option value="1938">1938</option>
				<option value="1937">1937</option>
				<option value="1936">1936</option>
				<option value="1935">1935</option>
				<option value="1934">1934</option>
				<option value="1933">1933</option>
				<option value="1932">1932</option>
				<option value="1931">1931</option>
				<option value="1930">1930</option>
				<option value="1929">1929</option>
				<option value="1928">1928</option>
				<option value="1927">1927</option>
				<option value="1926">1926</option>
				<option value="1925">1925</option>
				<option value="1924">1924</option>
				<option value="1923">1923</option>
				<option value="1922">1922</option>
				<option value="1921">1921</option>
				<option value="1920">1920</option>
				<option value="1919">1919</option>
				<option value="1918">1918</option>
				<option value="1917">1917</option>
				<option value="1916">1916</option>
				<option value="1915">1915</option>
				<option value="1914">1914</option>
				<option value="1913">1913</option>
				<option value="1912">1912</option>
				<option value="1911">1911</option>
				<option value="1910">1910</option>
				<option value="1909">1909</option>
				<option value="1908">1908</option>
				<option value="1907">1907</option>
				<option value="1906">1906</option>
				<option value="1905">1905</option>
				<option value="1904">1904</option>
				<option value="1903">1903</option>
				<option value="1901">1901</option>
				<option value="1900">1900</option>
			</select>
			<br><br>
			<input id="registersubmit" type="submit" value="Register">
		</div>
		<div class="contnt" id="settings" style="display: none; ">
			<h1> Settings: </h1><br>
			<div class="stngs" id="keybind" style="height: 700px;">
				<h2>Keybindings</h2>
				<p>Left key:</p>
				<img src=./resources/images/pac.png width=50px height=50px style="transform: rotate(180deg);" /><br><br>
				<input class="keybindL" id="leftK" type="label" maxlength="0" /><br>
				<p>Right key:</p>
				<img src=./resources/images/pac.png width=50px height=50px /><br><br>
				<input class="keybindL" id="rightK" type="label" maxlength="0" /><br>
				<p>Down key:</p>
				<img src=./resources/images/pac.png width=50px height=50px style="transform: rotate(90deg);" /><br><br>
				<input class="keybindL" id="downK" type="label" maxlength="0" /><br>
				<p>Up key:</p>
				<img src=./resources/images/pac.png width=50px height=50px style="transform: rotate(270deg);" /><br><br>
				<input class="keybindL" id="upK" type="label" maxlength="0" /><br>
			</div>
			<div class="stngs" id="balls">
				<h2>Balls</h2>
				<p>Number of balls:</p>
				<input type="range" min="50" max="90" value="70" class="slider" id="myRange">
				<span id="f" style="font-weight: bold; color: yellow;"></span><br>
				<div class="stngs" id="ball1">
					<h3>Ball 1 (60%):</h3>
					<p>Color:</p>
					<select class="ball-color" name="ball1-color" id="ball1c">
						<option selected value="yellow">Yellow</option>
						<option value="orange">Orange</option>
						<option value="white">White</option>
						<option value="fuchsia">Pink</option>
						<option value="green">Green</option>
						<option value="DodgerBlue">Blue</option>
					</select>
					<p>Points:</p>
					<input id="ball1p" type="number" min="0" value="5" /><br>
				</div><br><br>
				<div class="stngs" id="ball2">

					<h3>Ball 2 (30%):</h3>
					<p>Color:</p>
					<select class="ball-color" name="ball2-color" id="ball2c">
						<option value="yellow">Yellow</option>
						<option selected value="orange">Orange</option>
						<option value="white">White</option>
						<option value="fuchsia">Pink</option>
						<option value="green">Green</option>
						<option value="DodgerBlue">Blue</option>
					</select>
					<p>Points:</p>
					<input id="ball2p" type="number" min="0" value="15" /><br>
				</div><br><br>
				<div class="stngs" id="ball3">
					<h3>Ball 3 (10%):</h3>
					<p>Color:</p>
					<select class="ball-color" name="ball3-color" id="ball3c">
						<option value="yellow">Yellow</option>
						<option value="orange">Orange</option>
						<option selected value="white">White</option>
						<option value="fuchsia">Pink</option>
						<option value="green">Green</option>
						<option value="DodgerBlue">Blue</option>
					</select>
					<p>Points:</p>
					<input id="ball3p" type="number" min="0" value="25" /><br>
				</div>
			</div>
			<div class="stngs" id="general" style="height:700px">
				<h2>General Settings</h2>
				<p>Time (Minimum 60s):</p>
				<img src=./resources/images/paclock.png width=50px height=50px /><br>
				<input id="time" type="number" min="60" value="60" /><br>
				<p>Number of enemies:</p>
				<img id="ghost" style="width:auto" height=50px /><br>
				<input type="range" min="1" max="4" value="2" class="slider" id="enemies">
				<span id="en" style="font-weight: bold; color: yellow;"></span><br>
			</div><br><br>
			<input id="randomSettings" type="submit" value="Random Settings">
			<input id="applySettings" type="submit" value="Apply Settings">
		</div>
		<div id="aboutModal" class="modal">
			<div class="modal-content">
				<div class="modal-header">
					<span class="close">&times;</span>
					<h2>About</h2>
				</div>
				<div class="modal-body">
					<!---------------------------- write text about -------------------------------->
				</div>
			</div>
		</div>
		<div id="game" style="display: none;">
			<br>
			<div id="score">
				<label for="lblScore">SCORE:</label>
				<input id="lblScore" type="text" />
			</div>
			<div id="time">
				<label for="lblTime">TIME:</label>
				<input id="lblTime" type="text" />
			</div>
			<canvas id="canvas" height="600" width="600"></canvas>
		</div>
	</div>

	<script>
		var users;
		var numOfUsers = 0;
		var contextBall1;
		var currentUser;
		var imageUrl = new Array();

		$(document).ready(function () {
			users = new Array;
			users[0] = { userName: "p", password: "p", fullName: "pp", email: "p@mail.com", dayb: "1", monthb: "1", yearb: "1900" }
			numOfUsers++;


			var str = $("#myRange").val();
			$("#f").html(str);

			var str = $("#enemies").val();
			$("#en").html(str);


			//settings

			defaultKeys();

			imageUrl[0] = "./resources/images/ghost1.png";
			imageUrl[1] = "./resources/images/ghost2.png";
			imageUrl[2] = "./resources/images/ghost3.png";
			imageUrl[3] = "./resources/images/ghost4.png";


			var slider = document.getElementById("myRange");
			var output = document.getElementById("f");

			output.innerHTML = slider.value;
			slider.oninput = function () {
				output.innerHTML = this.value;
			}

			var slider2 = document.getElementById("enemies");
			var output2 = document.getElementById("en");
			output2.innerHTML = slider2.value;
			$("#ghost").prop("src", imageUrl[slider2.value - 1]);
			slider2.oninput = function () {
				output2.innerHTML = this.value;
				$("#ghost").prop("src", imageUrl[this.value - 1]);
			}

			var colorStr = $("#ball1c").val();
			$("#ball1").attr("style", "border-color:" + colorStr + "; color:" + colorStr + "; width:95%");

			var colorStr = $("#ball2c").val();
			$("#ball2").attr("style", "border-color:" + colorStr + "; color:" + colorStr + "; width:95%");

			var colorStr = $("#ball3c").val();
			$("#ball3").attr("style", "border-color:" + colorStr + "; color:" + colorStr + "; width:95%");


		});

		$("#loginb").click(function () {

			clicklogin();
		});

		$("#loginbig").click(function () {
			clicklogin();
		});

		$("#registerb").click(function () {
			clickregister();
		});


		$("#registerbig").click(function () {
			clickregister();
		});

		$("#settingsb").click(function () {
			if (currentUser != null) {
				clicksettings();
			} else {
				clicklogin();
			}
		});

		$("#aboutb").click(function () {
			var modal = document.getElementById("aboutModal");
			modal.style.display = "block";
		});


		$("#playb").click(function () {
			if (currentUser != null) {
				showGame();
			}
			else {
				clicklogin();
			}
		});

		$(".close").click(function () {
			var span = document.getElementsByClassName("close")[0];
			var modal = document.getElementById("aboutModal");
			modal.style.display = "none";
		});

		window.onclick = function (event) {
			var modal = document.getElementById("aboutModal");
			if (event.target == modal) {
				modal.style.display = "none";
			}
		}

		//disable scrolling with keys
		window.addEventListener("keydown", function (e) {
			if ([32, 37, 38, 39, 40].indexOf(e.keyCode) > -1) {
				e.preventDefault();
			}
		}, false);

		$(document).keyup(function (e) {
			if (e.keyCode === 27) {
				var modal = document.getElementById("aboutModal");
				modal.style.display = "none";
			}
		});




		$("#loginsubmit").click(function () {
			currentUser = validateLogin(users, numOfUsers);
			if (currentUser != null) {
				clicksettings();
			}
		});

		$("#registersubmit").click(function () {
			currentUser = validateRegistration(users, numOfUsers);
			if (currentUser != null) {
				numOfUsers++;
				//alert("Welcome " + currentUser[0]);
				clicksettings();
			}
		});




		$("#applySettings").click(function () {
			if (validateSettings() == true) {
				//apply vars
			}
		});

		$("#randomSettings").click(function () {

			defaultKeys();

			//random balls

			var ballsR = Math.floor((Math.random() * 41) + 50);
			$("#myRange").val(ballsR);
			$("#f").html(ballsR);

			var $options = $('#ball1c').find('option'),
				random = ~~(Math.random() * $options.length);
			$options.eq(random).prop('selected', true);
			var colorStr = $("#ball1c").val();
			$("#ball1").attr("style", "border-color:" + colorStr + "; color:" + colorStr + "; width:95%");

			var $options = $('#ball2c').find('option'),
				random = ~~(Math.random() * $options.length);
			$options.eq(random).prop('selected', true);
			while ($("#ball2c").val() == $("#ball1c").val()) {
				var $options = $('#ball2c').find('option'),
					random = ~~(Math.random() * $options.length);
				$options.eq(random).prop('selected', true);
			}
			var colorStr = $("#ball2c").val();
			$("#ball2").attr("style", "border-color:" + colorStr + "; color:" + colorStr + "; width:95%");

			var $options = $('#ball3c').find('option'),
				random = ~~(Math.random() * $options.length);
			$options.eq(random).prop('selected', true);
			while ($("#ball3c").val() == $("#ball1c").val() || $("#ball3c").val() == $("#ball2c").val()) {
				var $options = $('#ball3c').find('option'),
					random = ~~(Math.random() * $options.length);
				$options.eq(random).prop('selected', true);
			}
			var colorStr = $("#ball3c").val();
			$("#ball3").attr("style", "border-color:" + colorStr + "; color:" + colorStr + "; width:95%");

			var points1 = Math.floor((Math.random() * 5) + 1);
			var points2 = Math.floor((Math.random() * 10) + 6);
			var points3 = Math.floor((Math.random() * 11) + 15);
			$("#ball1p").val(points1);
			$("#ball2p").val(points2);
			$("#ball3p").val(points3);

			//random general
			var timeR = Math.floor((Math.random() * 120) + 60);
			$("#time").val(timeR);

			var enemiesR = Math.floor((Math.random() * 4) + 1);
			$("#enemies").val(enemiesR);
			$("#en").val(enemiesR);
			var enO = document.getElementById("en");
			enO.innerHTML = enemiesR;
			$("#ghost").prop("src", imageUrl[enemiesR - 1]);

		});

		var prevkey;

		function defaultKeys() {
			$("#leftK").val("ArrowLeft");
			$("#rightK").val("ArrowRight");
			$("#upK").val("ArrowUp");
			$("#downK").val("ArrowDown");
		}

		$(".keybindL").click(function () {
			prevkey = $(this).val();
			$(this).val("Please select a key...");
		});

		$(".keybindL")
			.focusout(function () {
				if ($(this).val() == "Please select a key...") {
					$(this).val(prevkey);
				}
			})


		$(".keybindL").bind('keydown', function (e) {
			var keypressed = e.key;
			if (keypressed == " ") {
				keypressed = "Space";
			}
			if (checkSimilarKeys(keypressed) == true) {

				$(this).val(keypressed);
			}
		});

		$("#logo").click(function () {
			d1 = document.getElementById("welcome");
			d2 = document.getElementById("login");
			d3 = document.getElementById("register");
			d4 = document.getElementById("settings");
			d5 = document.getElementById("game");
			d1.style.display = "block";
			d2.style.display = "none";
			d3.style.display = "none";
			d4.style.display = "none";
			d5.style.display = "none";
		});

		//color1
		(function () {
			var previous;
			$("#ball1c").on('focus', function () {
				previous = this.value;
			}).change(function () {
				if ($("#ball2c").val() == $("#ball1c").val() || $("#ball3c").val() == $("#ball1c").val()) {
					$("#ball1c").val(previous);
					alert("Color is already taken");
				}
				else {
					var colorStr = $("#ball1c").val();
					$("#ball1").attr("style", "border-color:" + colorStr + "; color:" + colorStr + "; width:95%");
					previous = this.value;
				}
			});
		})();

		//color2
		(function () {
			var previous;
			$("#ball2c").on('focus', function () {
				previous = this.value;
			}).change(function () {
				if ($("#ball2c").val() == $("#ball1c").val() || $("#ball2c").val() == $("#ball3c").val()) {
					$("#ball2c").val(previous);
					alert("Color is already taken");
				}
				else {
					var colorStr = $("#ball2c").val();
					$("#ball2").attr("style", "border-color:" + colorStr + "; color:" + colorStr + "; width:95%");
					previous = this.value;
				}
			});
		})();

		//color3
		(function () {
			var previous;
			$("#ball3c").on('focus', function () {
				previous = this.value;
			}).change(function () {
				if ($("#ball2c").val() == $("#ball3c").val() || $("#ball1c").val() == $("#ball3c").val()) {
					$("#ball3c").val(previous);
					alert("Color is already taken");
				}
				else {
					var colorStr = $("#ball3c").val();
					$("#ball3").attr("style", "border-color:" + colorStr + "; color:" + colorStr + "; width:95%");
					previous = this.value;
				}
			});
		})();

		function checkSimilarKeys(keypressed) {
			if ($("#leftK").val() == keypressed || $("#rightK").val() == keypressed || $("#upK").val() == keypressed || $("#downK").val() == keypressed) {
				return false;
			}
			return true;
		}

		function clicklogin() {
			d1 = document.getElementById("welcome");
			d2 = document.getElementById("login");
			d3 = document.getElementById("register");
			d4 = document.getElementById("settings");
			d5 = document.getElementById("game");
			d1.style.display = "none";
			d2.style.display = "block";
			d3.style.display = "none";
			d4.style.display = "none";
			d5.style.display = "none";
		}

		function clickregister() {
			d1 = document.getElementById("welcome");
			d2 = document.getElementById("login");
			d3 = document.getElementById("register");
			d4 = document.getElementById("settings");
			d5 = document.getElementById("game");
			d1.style.display = "none";
			d2.style.display = "none";
			d3.style.display = "block";
			d4.style.display = "none";
			d5.style.display = "none";
		}

		function clicksettings() {
			d1 = document.getElementById("welcome");
			d2 = document.getElementById("login");
			d3 = document.getElementById("register");
			d4 = document.getElementById("settings");
			d5 = document.getElementById("game");
			d1.style.display = "none";
			d2.style.display = "none";
			d3.style.display = "none";
			d4.style.display = "block";
			d5.style.display = "none";
		}

		function showGame() {
			d1 = document.getElementById("welcome");
			d2 = document.getElementById("login");
			d3 = document.getElementById("register");
			d4 = document.getElementById("settings");
			d5 = document.getElementById("game");
			d1.style.display = "none";
			d2.style.display = "none";
			d3.style.display = "none";
			d4.style.display = "none";
			d5.style.display = "block";
			Start();
		}


	</script>
</body>

</html>